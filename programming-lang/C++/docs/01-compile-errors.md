# 編譯與報錯
為了讓編程語言更貼近人類的語言，高級程式碼都是由機器碼包裝而成的。而讓機器理解我們的指令，我們需要把程式碼編譯成能讓機器識別的機器碼。這裡會解釋什麼是編譯語言以及當中的原理，與其相對的直譯語言的介紹。還有不同類型的報錯和如何去解決。

## 什麼是編譯語言
C與C++都是一個編譯語言，編譯語言在實行程式前，會先透過編譯器把程式的代碼全部編譯(compile)成電腦能看懂的機器碼再去執行程式。而相對的就是直譯語言，會在程式執行當中一行一行的直譯(interpret)成為機器碼。直譯語言可以讓開發者更彈性和快速的測試程式。只不過相較先把程式碼整個編譯再執行的編譯語言，直譯語言的執行速度就慢了不少。

## 編譯語言的過程
編譯語言在執行程式碼前需要經過主要四個步驟，包括預處理、編譯、匯編、鏈接。
### 預處理
預處理的過程會 1) 把所有的預編譯指令 `#`相對應的處理，例如 `#include`會把被包含的頭文件插入該編譯指令的位置。這也是一個遞歸的過程，因為頭文件也可能會包含了其他的文件。 2) 去掉所有的注釋 `//`, `/**/`。 3) 把所有的宏定義 `#define`變量的值代入程式碼裡所有的宏變量裡，然後刪除。

我們可以利用簡單的指令去驗證，先創建一個C++的程式檔案，利用指令的選項去只執行預處理的步驟，這樣就可以看到預處理後的程式碼。
```cpp
// test.cpp
#include<iostream>

int main() {
    std::cout << "Hello World!" << std::endl;
    return 0;
}
```
```console
g++ -E ./test.cpp
```

### 編譯與匯編
編譯的過程就是把預處理後的文件進行語法分析以及優化，如果語法有問題就會報錯。通過後則會生成匯編代碼，這些文件稱為中間代碼（字節碼），然後等待被匯編。匯編器會將由編譯生成的匯編代碼逐步轉換成二進制機器碼（目標文件），即機器可以執行的指令。只不過到現在生成的目標文件還不能被執行，要先通過鏈接後合成的可執行檔才可以。
### 鏈接
鏈接器會生成可執行的程序，可執行文件 (例如`.exe`)與中間件文件的格式一樣，那為什麼匯編後的同樣是二進制機器碼，但是不能直接執行？因為編譯時並不是把多個文件整合後再進行的，而是每一個文件進行預處理、編譯、匯編才生成的`.o`文件。當我們在一個文件中引用了其他文件中的變量或函數時，本地文件並不找到想要引用的函數的地址，所以我們需要鏈接器去把不同的目標文件去鏈接在一起。

簡單來說，鏈接器會把匯編後產生的各個目標文件組合成一個可執行的文件，過程則是把還沒定義標識符引用替換成對應的地址，例如把標準庫等的系統組件結合起來。

---